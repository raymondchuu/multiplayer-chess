{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/RaymondChu/react-chess/client/src/components/VideoCall/VideoCall.js\";\nimport React, { useRef, useState, useEffect } from 'react';\nimport { socket } from '../../socket/socket';\nimport Peer from 'simple-peer';\nexport default function VideoCall(props) {\n  var _s = $RefreshSig$();\n\n  function callPeer(username) {\n    _s();\n\n    const [callAccepted, setCallAccepted] = useState(false);\n    const [stream, setStream] = useState();\n    const partnerVideo = useRef();\n    useEffect(() => {\n      navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      }).then(stream => {\n        setStream(stream);\n      });\n    });\n    const peer = new Peer({\n      initiator: true,\n      trickle: false,\n      stream: stream\n    });\n    peer.on(\"signal\", data => {\n      socket.emit(\"callUser\", {\n        userToCall: username,\n        signalData: data,\n        from: props.username,\n        gameId: props.gameId\n      });\n    });\n    peer.on(\"stream\", stream => {\n      if (partnerVideo.current) {\n        partnerVideo.current.srcObject = stream;\n      }\n    });\n    socket.on(\"callAccepted\", signal => {\n      setCallAccepted(true);\n      peer.signal(signal);\n    });\n  }\n\n  _s(callPeer, \"MtuE0WK8ewAQDAnrohYjH/pT2E8=\");\n\n  function acceptCall() {}\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"hi\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 9\n  }, this);\n}\n_c = VideoCall;\n\nvar _c;\n\n$RefreshReg$(_c, \"VideoCall\");","map":{"version":3,"sources":["/Users/RaymondChu/react-chess/client/src/components/VideoCall/VideoCall.js"],"names":["React","useRef","useState","useEffect","socket","Peer","VideoCall","props","callPeer","username","callAccepted","setCallAccepted","stream","setStream","partnerVideo","navigator","mediaDevices","getUserMedia","video","audio","then","peer","initiator","trickle","on","data","emit","userToCall","signalData","from","gameId","current","srcObject","signal","acceptCall"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,MAAhB,EAAwBC,QAAxB,EAAkCC,SAAlC,QAAmD,OAAnD;AACA,SAASC,MAAT,QAAuB,qBAAvB;AACA,OAAOC,IAAP,MAAiB,aAAjB;AAEA,eAAe,SAASC,SAAT,CAAmBC,KAAnB,EAA0B;AAAA;;AAErC,WAASC,QAAT,CAAkBC,QAAlB,EAA4B;AAAA;;AACxB,UAAM,CAACC,YAAD,EAAeC,eAAf,IAAkCT,QAAQ,CAAC,KAAD,CAAhD;AACA,UAAM,CAACU,MAAD,EAASC,SAAT,IAAsBX,QAAQ,EAApC;AAGA,UAAMY,YAAY,GAAGb,MAAM,EAA3B;AAEAE,IAAAA,SAAS,CAAC,MAAM;AACZY,MAAAA,SAAS,CAACC,YAAV,CAAuBC,YAAvB,CAAoC;AAAEC,QAAAA,KAAK,EAAE,IAAT;AAAeC,QAAAA,KAAK,EAAE;AAAtB,OAApC,EACCC,IADD,CACOR,MAAD,IAAY;AACdC,QAAAA,SAAS,CAACD,MAAD,CAAT;AACH,OAHD;AAIH,KALQ,CAAT;AAOA,UAAMS,IAAI,GAAG,IAAIhB,IAAJ,CAAS;AAClBiB,MAAAA,SAAS,EAAE,IADO;AAElBC,MAAAA,OAAO,EAAE,KAFS;AAGlBX,MAAAA,MAAM,EAAEA;AAHU,KAAT,CAAb;AAMAS,IAAAA,IAAI,CAACG,EAAL,CAAQ,QAAR,EAAkBC,IAAI,IAAI;AACtBrB,MAAAA,MAAM,CAACsB,IAAP,CAAY,UAAZ,EAAwB;AAAEC,QAAAA,UAAU,EAAElB,QAAd;AAAwBmB,QAAAA,UAAU,EAAEH,IAApC;AAA0CI,QAAAA,IAAI,EAAEtB,KAAK,CAACE,QAAtD;AAAgEqB,QAAAA,MAAM,EAAEvB,KAAK,CAACuB;AAA9E,OAAxB;AACH,KAFD;AAIAT,IAAAA,IAAI,CAACG,EAAL,CAAQ,QAAR,EAAkBZ,MAAM,IAAI;AACxB,UAAIE,YAAY,CAACiB,OAAjB,EAA0B;AACtBjB,QAAAA,YAAY,CAACiB,OAAb,CAAqBC,SAArB,GAAiCpB,MAAjC;AACH;AACJ,KAJD;AAMAR,IAAAA,MAAM,CAACoB,EAAP,CAAU,cAAV,EAA0BS,MAAM,IAAI;AAChCtB,MAAAA,eAAe,CAAC,IAAD,CAAf;AACAU,MAAAA,IAAI,CAACY,MAAL,CAAYA,MAAZ;AACH,KAHD;AAIH;;AApCoC,KAE5BzB,QAF4B;;AAsCrC,WAAS0B,UAAT,GAAsB,CACrB;;AAED,sBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AAKH;KA9CuB5B,S","sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport { socket } from '../../socket/socket';\nimport Peer from 'simple-peer';\n\nexport default function VideoCall(props) {\n\n    function callPeer(username) {\n        const [callAccepted, setCallAccepted] = useState(false);\n        const [stream, setStream] = useState();\n\n\n        const partnerVideo = useRef();\n\n        useEffect(() => {\n            navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n            .then((stream) => {\n                setStream(stream);\n            })\n        });\n\n        const peer = new Peer({\n            initiator: true,\n            trickle: false,\n            stream: stream,\n        });\n\n        peer.on(\"signal\", data => {\n            socket.emit(\"callUser\", { userToCall: username, signalData: data, from: props.username, gameId: props.gameId })\n        });\n\n        peer.on(\"stream\", stream => {\n            if (partnerVideo.current) {\n                partnerVideo.current.srcObject = stream;\n            }\n        });\n\n        socket.on(\"callAccepted\", signal => {\n            setCallAccepted(true);\n            peer.signal(signal);\n        });\n    }\n\n    function acceptCall() {\n    }\n\n    return(\n        <div>\n            hi\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}