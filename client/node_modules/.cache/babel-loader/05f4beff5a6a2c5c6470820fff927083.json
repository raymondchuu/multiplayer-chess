{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/RaymondChu/react-chess/client/src/components/VideoCall/VideoCall.js\";\nimport React, { useRef, useState, useEffect } from 'react';\nimport { socket } from '../../socket/socket';\nimport Peer from 'simple-peer';\nexport default function VideoCall(props) {\n  var _s = $RefreshSig$();\n\n  function callPeer(username) {\n    _s();\n\n    const [callAccepted, setCallAccepted] = useState(false);\n    const [stream, setStream] = useState();\n    const [receivingCall, setReceivingCall] = useState(false);\n    const [caller, setCaller] = useState(\"\");\n    const [callerSignal, setCallerSignal] = useState();\n    const userVideo = useRef();\n    const partnerVideo = useRef();\n    useEffect(() => {\n      navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      }).then(stream => {\n        setStream(stream);\n\n        if (userVideo.current) {\n          userVideo.current.srcObject = stream;\n        }\n      });\n      socket.on(\"hello\", data => {\n        setReceivingCall(true);\n        setCaller(data.from);\n        setCallerSignal(data.signal);\n      });\n    });\n    const peer = new Peer({\n      initiator: true,\n      trickle: false,\n      stream: stream\n    });\n    peer.on(\"signal\", data => {\n      socket.emit(\"callUser\", {\n        userToCall: username,\n        signalData: data,\n        from: props.username,\n        gameId: props.gameId\n      });\n    });\n    peer.on(\"stream\", stream => {\n      if (partnerVideo.current) {\n        partnerVideo.current.srcObject = stream;\n      }\n    });\n    socket.on(\"callAccepted\", signal => {\n      setCallAccepted(true);\n      peer.signal(signal);\n    });\n  }\n\n  _s(callPeer, \"BA2+aTCrx41BVCbf2a0tdYE5Erk=\");\n\n  function acceptCall() {\n    setCallAccepted(true);\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream: stream\n    });\n    peer.on(\"signal\", data => {\n      socket.emit(\"acceptCall\", {\n        signal: data,\n        to: caller\n      });\n    });\n    peer.on(\"stream\", stream => {\n      partnerVideo.current.srcObject = stream;\n    });\n    peer.signal(callerSignal);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"hi\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 9\n  }, this);\n}\n_c = VideoCall;\n\nvar _c;\n\n$RefreshReg$(_c, \"VideoCall\");","map":{"version":3,"sources":["/Users/RaymondChu/react-chess/client/src/components/VideoCall/VideoCall.js"],"names":["React","useRef","useState","useEffect","socket","Peer","VideoCall","props","callPeer","username","callAccepted","setCallAccepted","stream","setStream","receivingCall","setReceivingCall","caller","setCaller","callerSignal","setCallerSignal","userVideo","partnerVideo","navigator","mediaDevices","getUserMedia","video","audio","then","current","srcObject","on","data","from","signal","peer","initiator","trickle","emit","userToCall","signalData","gameId","acceptCall","to"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport { socket } from '../../socket/socket';\nimport Peer from 'simple-peer';\n\nexport default function VideoCall(props) {\n\n    function callPeer(username) {\n        const [callAccepted, setCallAccepted] = useState(false);\n        const [stream, setStream] = useState();\n        const [receivingCall, setReceivingCall] = useState(false);\n        const [caller, setCaller] = useState(\"\");\n        const [callerSignal, setCallerSignal] = useState();\n\n        const userVideo = useRef();\n        const partnerVideo = useRef();\n\n        useEffect(() => {\n            navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n            .then((stream) => {\n                setStream(stream);\n                if (userVideo.current) {\n                    userVideo.current.srcObject = stream;\n                }\n            })\n\n            socket.on(\"hello\", (data) => {\n                setReceivingCall(true);\n                setCaller(data.from);\n                setCallerSignal(data.signal);\n            })\n        });\n\n        const peer = new Peer({\n            initiator: true,\n            trickle: false,\n            stream: stream,\n        });\n\n        peer.on(\"signal\", data => {\n            socket.emit(\"callUser\", { userToCall: username, signalData: data, from: props.username, gameId: props.gameId })\n        });\n\n        peer.on(\"stream\", stream => {\n            if (partnerVideo.current) {\n                partnerVideo.current.srcObject = stream;\n            }\n        });\n\n        socket.on(\"callAccepted\", signal => {\n            setCallAccepted(true);\n            peer.signal(signal);\n        });\n    }\n\n    function acceptCall() {\n        setCallAccepted(true);\n        const peer = new Peer({\n            initiator: false,\n            trickle: false,\n            stream: stream,\n        });\n\n        peer.on(\"signal\", data => {\n            socket.emit(\"acceptCall\", { signal: data, to: caller});\n        });\n\n        peer.on(\"stream\", stream => {\n            partnerVideo.current.srcObject = stream;\n        });\n\n        peer.signal(callerSignal);\n    }\n\n    return(\n        <div>\n            hi\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}